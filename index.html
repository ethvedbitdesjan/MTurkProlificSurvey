<!DOCTYPE html>
<html>
<head>
  <title>Funny Image Rating Survey</title>
  <h1> Funny Image Rating Survey</h1>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }

    #image-container {
      text-align: center;
      margin-bottom: 20px;
    }

    #rating-container {
      text-align: center;
    }

    #rating-buttons {
      margin-top: 10px;
    }

    #welcome {
      text-align: center;
      /*add css tags for a welcome page*/
      margin: 20px;
      font-size: 2em;
      font-family: sans-serif;
    }
    
    .rating-button {
      margin: 3px;
      color: yellow;
      background-color: blue;
      border-radius: 5px;
      text-align: center;
      padding: 5px;
      font-size: 0.8em;
    }

    #start-button {
      margin-top: 20px;
      color: yellow;
      background-color: blue;
      border-radius: 10px;
      text-align: center;
      padding: 10px;
      font-size: 1.5em;
      font-family: Arial;
    }
  </style>
</head>
<body>
  <div id="welcome">
    <p> Welcome to the Funny Image Rating Survey! </p>
    <p> Please rate the funniness of the images below on a scale of 1 to 10. </p>
    <p> For rating all the images, you will receive $1.00</p>
    <p> Please do not refresh the page. You will lose progress and will have to start again. </p>
    <p> There are 50 images in this survey</p>
    <p> At the end of the survey, we will provide you a code, please store it and use it appropriately to get the reward.</p>
    <p> Click the button below to begin. </p>
    <button class="start-button" value="1" id="start-button"> Let's Start</button>
  </div>
  <div id="image-container" style="display: none;">
    <img id="image" src="" alt="Image" height="300">
  </div>

  <div id="rating-container" style="display: none;">
    <p>How funny is the image?</p>
    <div id="rating-buttons">
      <button class="rating-button" value="1">1</button>
      <button class="rating-button" value="2">2</button>
      <button class="rating-button" value="3">3</button>
      <button class="rating-button" value="4">4</button>
      <button class="rating-button" value="5">5</button>
      <button class="rating-button" value="6">6</button>
      <button class="rating-button" value="7">7</button>
      <button class="rating-button" value="8">8</button>
      <button class="rating-button" value="9">9</button>
      <button class="rating-button" value="10">10</button>
    </div>
  </div>
  <div id="thanks" style="display: none;">
    <p>Thank you for your time!</p>
  </div>

  <script>
    var imageUrls = [
      "https://drive.google.com/uc?export=view&id=1T_ZRpOYfFZbvmSgdxEXk-QyHJsafQZ1l",
      "http://timbrady.org/turk/images/car.jpg",
      "http://timbrady.org/turk/images/tissues.jpg"
      // Add more image URLs as needed
    ];

    var imageIndex = 0;
    var startTime = 0;
    var rating = 0;

    var image = document.getElementById('image');
    var ratingButtons = document.getElementsByClassName('rating-button');

    function displayImage() {
      image.src = imageUrls[imageIndex];
      startTime = new Date().getTime();
    }

    function recordRating(buttonValue) {
      rating = buttonValue;
      if (imageIndex < imageUrls.length - 1) {
        imageIndex++;
        displayImage();
      } else {
        // Submit the rating or perform any desired action
        console.log('Rating:', rating);
        var rating_container = document.getElementById('rating-container');
        if (rating_container.style.display === 'none') {
          rating_container.style.display = 'block';
        } else {
          rating_container.style.display = 'none';
        }
        var image_container = document.getElementById('image-container');
        if (image_container.style.display === 'none') {
          image_container.style.display = 'block';
        } else {
          image_container.style.display = 'none';
        }
        var thanks = document.getElementById('thanks');
        if (thanks.style.display === 'none') {
          thanks.style.display = 'block';
        } else {
          thanks.style.display = 'none';
        }
        var code = Math.random() * 1000000;
        thanks.getElementsByTagName('p')[0].innerHTML += ' Your code is ' + code.toFixed(0);
        return;
      }
      var url = 'https://4c2nw4esdbqfj37qsqg3degzwq0vnlya.lambda-url.us-east-2.on.aws/';
      url += '?link=' + image.src + '&rating=' + rating;
      fetch(url)
    .then(function (response) {
      console.log('sent');
    })
    .catch(function (error) {
      console.log("Error: " + error);
    });
    }

    // Add event listeners to rating buttons
    for (var i = 0; i < ratingButtons.length; i++) {
      ratingButtons[i].addEventListener('click', function() {
        var buttonValue = parseInt(this.value);
        recordRating(buttonValue);
      });
    }
    
    var start_button = document.getElementsByClassName('start-button')[0];
    start_button.addEventListener('click', function() {
      var welcome = document.getElementById('welcome');
      if (welcome.style.display === 'none') {
        welcome.style.display = 'block';
      } else {
        welcome.style.display = 'none';
      }
      console.log(welcome.style.display);
      var rating_container = document.getElementById('rating-container');
      console.log(rating_container.style.display);
      if (rating_container.style.display === 'none') {
        rating_container.style.display = 'block';
        console.log(rating_container.style.display);
      } else {
        rating_container.style.display = 'none';
      }
      var image_container = document.getElementById('image-container');
      if (image_container.style.display === 'none') {
        image_container.style.display = 'block';
      } else {
        image_container.style.display = 'none';
      }
      displayImage();
    });
    // Set minimum question answering time (2 seconds)
    setTimeout(function() {
      if (rating === 0) {
        // Do something if the user hasn't provided a rating
      }
    }, 2000);

    // Initial image display
    //displayImage();
  </script>
</body>
</html>
